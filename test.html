<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TV4WAP Player</title>

<!-- DASH.js for MPD -->
<script src="https://cdn.jsdelivr.net/npm/dashjs@4.7.3/dist/dash.all.min.js"></script>

<!-- HLS.js for M3U8 -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
  body {
    margin: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  video {
    width: 100%;
    height: 100%;
    background-color: black;
    outline: none;
  }
</style>
</head>
<body>

<video id="videoPlayer" controls autoplay playsinline></video>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const urlParams = new URLSearchParams(window.location.search);
  const streamId = urlParams.get("id");
  const video = document.getElementById("videoPlayer");

  if (!streamId) {
    video.poster = "";
    alert("No stream ID found!");
    return;
  }

  fetch("https://raw.githubusercontent.com/Shubhamkur/Tv/refs/heads/main/tv")
    .then(res => res.json())
    .then(data => {
      const stream = data.find(item => item.id === streamId);
      if (!stream) {
        alert("Stream not found!");
        return;
      }

      let source = stream.mpd || stream.m3u8 || stream.mp4 || stream.url;

      if (!source) {
        alert("No playable URL found for this stream.");
        return;
      }

      // Handle DASH (.mpd)
      if (source.includes(".mpd")) {
        if (dashjs.supportsMediaSource()) {
          const player = dashjs.MediaPlayer().create();
          player.initialize(video, source, true);
          console.log("Playing DASH stream:", source);
        } else {
          alert("Your browser does not support DASH playback.");
        }

      // Handle HLS (.m3u8)
      } else if (source.includes(".m3u8")) {
        if (Hls.isSupported()) {
          const hls = new Hls();
          hls.loadSource(source);
          hls.attachMedia(video);
          console.log("Playing HLS stream:", source);
        } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
          video.src = source;
        } else {
          alert("Your browser does not support HLS playback.");
        }

      // Handle direct MP4 or other open format
      } else {
        video.src = source;
        console.log("Playing direct stream:", source);
      }
    })
    .catch(err => {
      console.error(err);
      alert("Error loading stream data.");
    });
});
</script>

</body>
</html>
